<!DOCTYPE html>
<html>
<head>
  <title>
    paint-js
  </title>

  <!-- import bootstrap -->
  <!-- <link rel="stylesheet" href="bootstrap_src/css/bootstrap.min.css"> -->
  <!-- <script src="bootstrap_src/js/bootstrap.js" type="text/javascript"></script> -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  <!-- include style -->
  <link href='style/style.css' rel='stylesheet' type='text/css'>
  <!-- style sliders -->
  <link href='style/slider-style.css' rel='stylesheet' type='text/css'>
  <!-- style swatches -->
  <link href='style/swatch-style.css' rel='stylesheet' type='text/css'>

  <!-- include fonts -->
  <link href="https://fonts.googleapis.com/css?family=Muli" rel="stylesheet">

  <!-- include scripts -->

  <!-- import Vue itself -->
  <script src="https://unpkg.com/vue/dist/vue.js"></script>
  <!-- <script src="vue_src/vue.js" type="text/javascript"></script> -->
  <!-- import color-selector component -->
  <script src="script/color-selector.js" type="text/javascript"></script>
  <!-- import color-sliders component -->
  <script src="script/color-sliders.js" type="text/javascript"></script>
  <!-- import color-swatch component -->
  <script src="script/color-swatch.js" type="text/javascript"></script>
  <!-- import paint-js-canvas component -->
  <script src="script/paint-js-canvas.js" type="text/javascript"></script>
  <!-- import utility-button component -->
  <script src="script/utility-button.js" type="text/javascript"></script>
  <!-- import tool-button component -->
  <script src="script/tool-button.js" type="text/javascript"></script>
  <!-- import tool-sliders component -->
  <script src="script/tool-sliders.js" type="text/javascript"></script>


</head>
<body>
  <div id="paint-js">
    <div id="toolbars">

      <ul class="row tab-area">
        <li class="tab" v-for="(tab, index) in tabs"><a href="javascript:void(0)" class="tablink" :class="{active: tab_selected == index}" @click="openTab(index)">
          {{ tabs[index] }}
        </a></li>
      </ul>

      <div id="utilities" class="row tabcontent" v-if="tab_selected == 0">
        <utility-button
          v-for="(button, index) in utility_buttons"
          :key="button"
          :button-name="button"
          @buttonpress="executeUtility(index)" >
        </utility-button>
      </div>

      <div id="tools" class="row" v-if="tab_selected == 1">
        <div class="col-xs-8">
          <div class="row">
            <div class="col-xs-2" v-for="(tool, index) in tools">
              <tool-button
                :key="tool"
                :button-name="tool.name"
                :selected="index == tool_selected"
                @buttonpress="selectTool(index)" >
              </tool-button>
            </div>
          </div>
        </div>
        <div class="col-xs-4">
          <tool-sliders
            v-for="(tool, index) in tools"
            v-if="index == tool_selected"
            :key="tool"
            :tool-properties="tools[index].properties" >
          </tool-sliders>
        </div>

      </div>

      <div id="colors" class="row" v-if="tab_selected == 2">

        <!-- TODO: wrap these into columns using bootstrap -->

        <div class="selector-container">
          <color-selector
            :selector-name="primary_swatch_name"
            :selected="primary_selected"
            :color-style="primary_style"
            @select="selectPrimarySwatch"
            @customswatch="customSwatchFromPrimary">
          </color-selector>
          <color-selector
            :selector-name="secondary_swatch_name"
            :selected="secondary_selected"
            :color-style="secondary_style"
            @select="selectSecondarySwatch"
            @customswatch="customSwatchFromSecondary">
          </color-selector>
          <color-sliders
            ref="primarycolorsliders"
            :color-prop="primary_color"
            :visible="primary_selected"
            @colorchanged="updatePrimaryColor">
          </color-sliders>
          <color-sliders
            ref="secondarycolorsliders"
            :color-prop="secondary_color"
            :visible="secondary_selected"
            @colorchanged="updateSecondaryColor">
          </color-sliders>
        </div>
        <div class="swatch-container">
          <color-swatch
            v-for="(swatch, index) in swatches"
            key="swatch"
            :rgb="swatch"
            :index="index"
            @swatch="updateSelector"
            @deleteswatch="deleteSwatch">
          </color-swatch>
        </div>

      </div>

      <div id="other" class="row tabcontent" v-if="tab_selected == 3">

        <a href="in_progress/color-sliders.html">Color Picker Demo</a>

      </div>



    </div>
    <div id="canvas-area">

      <paint-js-canvas
      ref="paintjscanvas"
      :primary-color="primary_color"
      :secondary-color="secondary_color"
      :primary-color-style="primary_style"
      :secondary-color-style="secondary_style" >
      </paint-js-canvas>

    </div>
  </div>



  <script>

    var vm = new Vue({
      el: '#paint-js',

      data: {
        tabs: ['Utilities', 'Tools', 'Colors', 'Other'],
        tab_selected: 0,

        tools:  [ { name: 'pencil', properties: { width: 1 } },
                  { name: 'brush', properties: { width: 5, hardness: 99 } },
                  { name: 'eraser', properties: { width: 5 } },
                  { name: 'bucket', properties: { leniency: 0 } },
                  { name: 'pen', properties: { width: 5, angle: 0 } },
                ],

        tool_selected: 0,

        primary_color: {red: 0, green: 0, blue: 0},
        secondary_color: {red: 0, green: 0, blue: 0},

        primary_swatch_name: "Primary",
        secondary_swatch_name: "Secondary",
        primary_selected: true,
        secondary_selected: false,
        primary_style: "rgba(0, 0, 0, 1)",
        secondary_style: "rgba(0, 0, 0, 1)",

        swatches:         [ { red: 255, green: 0, blue: 0 },
                            { red: 200, green: 20, blue: 40 },
                            { red: 160, green: 40, blue: 80 },
                            { red: 120, green: 60, blue: 120 },
                            { red: 80, green: 80, blue: 160 },
                            { red: 40, green: 100, blue: 200 },
                            { red: 0, green: 120, blue: 255 },
                            { red: 20, green: 140, blue: 0 },
                            { red: 40, green: 160, blue: 40 },
                            { red: 60, green: 180, blue: 80 },
                            { red: 80, green: 200, blue: 120 },
                            { red: 100, green: 220, blue: 160 },
                            { red: 120, green: 240, blue: 200 },
                            { red: 140, green: 255, blue: 240 },
                            { red: 160, green: 0, blue: 255 },
                            { red: 180, green: 40, blue: 240 },
                            { red: 200, green: 80, blue: 220 },
                            { red: 220, green: 120, blue: 200 },
                            { red: 240, green: 160, blue: 180 },
                            { red: 255, green: 200, blue: 160 },
                            { red: 240, green: 255, blue: 140 },
                            { red: 220, green: 180, blue: 120 },
                            { red: 200, green: 100, blue: 100 },
                            { red: 180, green: 0, blue: 80 },
                            { red: 160, green: 100, blue: 60 },
                            { red: 140, green: 180, blue: 40 },
                            { red: 120, green: 255, blue: 20 },
                            { red: 100, green: 240, blue: 0 },
                            { red: 80, green: 200, blue: 60 },
                            { red: 60, green: 100, blue: 120 },
        ],

        utility_buttons: ['Save', 'Load', 'Undo', 'Redo', 'Clear'],

      },

      methods: {
        openTab: function(tab) {
          this.tab_selected = tab;
        },
        executeUtility: function(utility) {
          if (utility == 0) {         // save
            this.saveCanvas();
          } else if (utility == 1) {  // load

            // TODO: GARRETT

          } else if (utility == 2) {  // undo

            // TODO: COREY

          } else if (utility == 3) {  // redo

            // TODO: COREY

          } else if (utility == 4) {  // clear
            this.clearCanvas();
          }
        },

        selectTool: function(t) {
          this.tool_selected = t;
        },

        updatePrimaryColor: function(e) {
          this.primary_color.red = e.red;
          this.primary_color.green = e.green;
          this.primary_color.blue = e.blue;
          this.primary_style = e.color_style;
        },
        updateSecondaryColor: function(e) {
          this.secondary_color.red = e.red;
          this.secondary_color.green = e.green;
          this.secondary_color.blue = e.blue;
          this.secondary_style = e.color_style;
        },

        selectPrimarySwatch: function(e) {
          this.primary_selected = true;
          this.secondary_selected = false;
        },
        selectSecondarySwatch: function(e) {
          this.secondary_selected = true;
          this.primary_selected = false;
        },

        updateSelector: function(e) {
          if (this.primary_selected) {
            this.primary_color.red = e.rgb.red;
            this.primary_color.green = e.rgb.green;
            this.primary_color.blue = e.rgb.blue;
            this.primary_style = "rgba(" + this.primary_color.red + ", " + this.primary_color.green + ", " + this.primary_color.blue + ", 1)";
            this.$refs.primarycolorsliders.updateChannels();
          } else {
            this.secondary_color.red = e.rgb.red;
            this.secondary_color.green = e.rgb.green;
            this.secondary_color.blue = e.rgb.blue;
            this.secondary_style = "rgba(" + this.secondary_color.red + ", " + this.secondary_color.green + ", " + this.secondary_color.blue + ", 1)";
            this.$refs.secondarycolorsliders.updateChannels();
          }
        },

        deleteSwatch: function(e) {
          this.swatches.splice(e, 1);
        },

        customSwatchFromPrimary: function() {
          this.swatches.splice(this.swatches.length, 0, {red: this.primary_color.red, green: this.primary_color.green, blue: this.primary_color.blue});
        },

        customSwatchFromSecondary: function() {
          this.swatches.splice(this.swatches.length, 0, {red: this.secondary_color.red, green: this.secondary_color.green, blue: this.secondary_color.blue});
        },

        saveCanvas: function() {
          // execute saveCanvas() method from child
          this.$refs.paintjscanvas.saveCanvas();
        },

        clearCanvas: function() {
          // execute clearCanvas() method from child
          this.$refs.paintjscanvas.clearCanvas();
        }

      }
    })

  </script>

</body>
</html>
